<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Juc-指南 | Rustic blog</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="huangqing的博客。">
    <meta name="keywords" content="hq-blog">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.77aad89f.css" as="style"><link rel="preload" href="/assets/js/app.70f22179.js" as="script"><link rel="preload" href="/assets/js/2.c58500da.js" as="script"><link rel="preload" href="/assets/js/75.51a2bc6f.js" as="script"><link rel="prefetch" href="/assets/js/10.e392f20f.js"><link rel="prefetch" href="/assets/js/100.737baad0.js"><link rel="prefetch" href="/assets/js/101.08a119dd.js"><link rel="prefetch" href="/assets/js/102.e5093334.js"><link rel="prefetch" href="/assets/js/103.957997bb.js"><link rel="prefetch" href="/assets/js/104.ba1a28e1.js"><link rel="prefetch" href="/assets/js/105.93a2fc14.js"><link rel="prefetch" href="/assets/js/106.5be2605e.js"><link rel="prefetch" href="/assets/js/107.f10779e7.js"><link rel="prefetch" href="/assets/js/108.07ae08e1.js"><link rel="prefetch" href="/assets/js/109.db606b98.js"><link rel="prefetch" href="/assets/js/11.779c3a9e.js"><link rel="prefetch" href="/assets/js/110.958d33eb.js"><link rel="prefetch" href="/assets/js/111.6ee8b638.js"><link rel="prefetch" href="/assets/js/112.83ba1984.js"><link rel="prefetch" href="/assets/js/113.a6e57c19.js"><link rel="prefetch" href="/assets/js/114.9e1c30a7.js"><link rel="prefetch" href="/assets/js/115.1cfd8e2a.js"><link rel="prefetch" href="/assets/js/116.2eb87c4a.js"><link rel="prefetch" href="/assets/js/117.ed795fd3.js"><link rel="prefetch" href="/assets/js/118.f22f7b1c.js"><link rel="prefetch" href="/assets/js/119.4cb90ea8.js"><link rel="prefetch" href="/assets/js/12.311e41ea.js"><link rel="prefetch" href="/assets/js/120.164eaf3b.js"><link rel="prefetch" href="/assets/js/121.b074f191.js"><link rel="prefetch" href="/assets/js/122.a92d71aa.js"><link rel="prefetch" href="/assets/js/123.dcb33e14.js"><link rel="prefetch" href="/assets/js/124.059d57fb.js"><link rel="prefetch" href="/assets/js/125.6295547f.js"><link rel="prefetch" href="/assets/js/126.f1fbb79d.js"><link rel="prefetch" href="/assets/js/127.18083075.js"><link rel="prefetch" href="/assets/js/128.180b3a78.js"><link rel="prefetch" href="/assets/js/129.256a4bcc.js"><link rel="prefetch" href="/assets/js/13.79001402.js"><link rel="prefetch" href="/assets/js/130.2dc72390.js"><link rel="prefetch" href="/assets/js/131.d784147d.js"><link rel="prefetch" href="/assets/js/132.fcd04086.js"><link rel="prefetch" href="/assets/js/133.0f224e87.js"><link rel="prefetch" href="/assets/js/134.d7806368.js"><link rel="prefetch" href="/assets/js/135.6ef89ab3.js"><link rel="prefetch" href="/assets/js/136.2a7eef22.js"><link rel="prefetch" href="/assets/js/137.cbc46fdd.js"><link rel="prefetch" href="/assets/js/138.4a856658.js"><link rel="prefetch" href="/assets/js/139.dac372f3.js"><link rel="prefetch" href="/assets/js/14.9655fc0f.js"><link rel="prefetch" href="/assets/js/140.b94d81bb.js"><link rel="prefetch" href="/assets/js/141.ec38e4f1.js"><link rel="prefetch" href="/assets/js/142.43f4d9c9.js"><link rel="prefetch" href="/assets/js/143.ccbbf749.js"><link rel="prefetch" href="/assets/js/144.f85fd5e5.js"><link rel="prefetch" href="/assets/js/145.29c4390a.js"><link rel="prefetch" href="/assets/js/146.760153d8.js"><link rel="prefetch" href="/assets/js/147.3d029610.js"><link rel="prefetch" href="/assets/js/148.991c5748.js"><link rel="prefetch" href="/assets/js/149.16f90c76.js"><link rel="prefetch" href="/assets/js/15.0373a3e1.js"><link rel="prefetch" href="/assets/js/150.21d3fcb5.js"><link rel="prefetch" href="/assets/js/151.ce54d0fd.js"><link rel="prefetch" href="/assets/js/152.d33c6570.js"><link rel="prefetch" href="/assets/js/153.f0632064.js"><link rel="prefetch" href="/assets/js/154.8f06feec.js"><link rel="prefetch" href="/assets/js/155.e38be030.js"><link rel="prefetch" href="/assets/js/156.531cca11.js"><link rel="prefetch" href="/assets/js/157.8f9258c2.js"><link rel="prefetch" href="/assets/js/158.623d8791.js"><link rel="prefetch" href="/assets/js/159.a51ee5a3.js"><link rel="prefetch" href="/assets/js/16.5ec6432d.js"><link rel="prefetch" href="/assets/js/160.0429208f.js"><link rel="prefetch" href="/assets/js/161.42077ae4.js"><link rel="prefetch" href="/assets/js/162.c4030903.js"><link rel="prefetch" href="/assets/js/163.58a048b5.js"><link rel="prefetch" href="/assets/js/164.47494e1b.js"><link rel="prefetch" href="/assets/js/165.2e929aee.js"><link rel="prefetch" href="/assets/js/166.113984c9.js"><link rel="prefetch" href="/assets/js/167.3a7ff723.js"><link rel="prefetch" href="/assets/js/168.b065ead6.js"><link rel="prefetch" href="/assets/js/169.d6ab0d59.js"><link rel="prefetch" href="/assets/js/17.78e686a5.js"><link rel="prefetch" href="/assets/js/170.d653f69b.js"><link rel="prefetch" href="/assets/js/171.458673eb.js"><link rel="prefetch" href="/assets/js/172.8b6c5126.js"><link rel="prefetch" href="/assets/js/173.97dd9db1.js"><link rel="prefetch" href="/assets/js/174.3ea7dea1.js"><link rel="prefetch" href="/assets/js/175.c02a8644.js"><link rel="prefetch" href="/assets/js/176.68ca520d.js"><link rel="prefetch" href="/assets/js/177.8b4cf416.js"><link rel="prefetch" href="/assets/js/178.b56dae3c.js"><link rel="prefetch" href="/assets/js/179.203d9387.js"><link rel="prefetch" href="/assets/js/18.51f8b73f.js"><link rel="prefetch" href="/assets/js/180.d17fd32c.js"><link rel="prefetch" href="/assets/js/181.87d692f7.js"><link rel="prefetch" href="/assets/js/182.93018019.js"><link rel="prefetch" href="/assets/js/183.89239b18.js"><link rel="prefetch" href="/assets/js/184.5cf19f43.js"><link rel="prefetch" href="/assets/js/185.b4102131.js"><link rel="prefetch" href="/assets/js/186.6f349542.js"><link rel="prefetch" href="/assets/js/187.8ede7a64.js"><link rel="prefetch" href="/assets/js/188.f43a0f91.js"><link rel="prefetch" href="/assets/js/189.36e58d88.js"><link rel="prefetch" href="/assets/js/19.ee4579ea.js"><link rel="prefetch" href="/assets/js/190.ceac00d1.js"><link rel="prefetch" href="/assets/js/191.54cdf77a.js"><link rel="prefetch" href="/assets/js/192.00fa4e89.js"><link rel="prefetch" href="/assets/js/193.c1f4bf74.js"><link rel="prefetch" href="/assets/js/194.f9541e52.js"><link rel="prefetch" href="/assets/js/195.6f2a62e6.js"><link rel="prefetch" href="/assets/js/196.59567dc2.js"><link rel="prefetch" href="/assets/js/197.edc17922.js"><link rel="prefetch" href="/assets/js/198.c7131e7b.js"><link rel="prefetch" href="/assets/js/199.b9ef2a23.js"><link rel="prefetch" href="/assets/js/20.6634e435.js"><link rel="prefetch" href="/assets/js/200.467cdd56.js"><link rel="prefetch" href="/assets/js/201.4111f4c0.js"><link rel="prefetch" href="/assets/js/202.917b0e37.js"><link rel="prefetch" href="/assets/js/203.9f427973.js"><link rel="prefetch" href="/assets/js/204.e1ff2d92.js"><link rel="prefetch" href="/assets/js/205.89d5ba35.js"><link rel="prefetch" href="/assets/js/206.5a8c817f.js"><link rel="prefetch" href="/assets/js/207.bf06d039.js"><link rel="prefetch" href="/assets/js/208.55d576dd.js"><link rel="prefetch" href="/assets/js/209.90a8dee6.js"><link rel="prefetch" href="/assets/js/21.a2ac9207.js"><link rel="prefetch" href="/assets/js/210.b217fb7b.js"><link rel="prefetch" href="/assets/js/211.0e4a8192.js"><link rel="prefetch" href="/assets/js/212.c92fdf40.js"><link rel="prefetch" href="/assets/js/213.c915a867.js"><link rel="prefetch" href="/assets/js/214.08334c46.js"><link rel="prefetch" href="/assets/js/215.71314b78.js"><link rel="prefetch" href="/assets/js/216.760b1721.js"><link rel="prefetch" href="/assets/js/217.eb51d5d3.js"><link rel="prefetch" href="/assets/js/218.41b28ddf.js"><link rel="prefetch" href="/assets/js/219.68a2c598.js"><link rel="prefetch" href="/assets/js/22.f9b137dc.js"><link rel="prefetch" href="/assets/js/220.5b345b21.js"><link rel="prefetch" href="/assets/js/221.5350be5b.js"><link rel="prefetch" href="/assets/js/222.5ce4b718.js"><link rel="prefetch" href="/assets/js/223.1b60cd05.js"><link rel="prefetch" href="/assets/js/224.d672379f.js"><link rel="prefetch" href="/assets/js/225.5dd556f7.js"><link rel="prefetch" href="/assets/js/226.dd26a11a.js"><link rel="prefetch" href="/assets/js/227.3617dea1.js"><link rel="prefetch" href="/assets/js/228.5f2ad89a.js"><link rel="prefetch" href="/assets/js/229.cf89d826.js"><link rel="prefetch" href="/assets/js/23.3f6bcb0b.js"><link rel="prefetch" href="/assets/js/230.0dd31287.js"><link rel="prefetch" href="/assets/js/231.a44e71ce.js"><link rel="prefetch" href="/assets/js/232.1eb3fdc0.js"><link rel="prefetch" href="/assets/js/233.183c339f.js"><link rel="prefetch" href="/assets/js/234.51ddd4cc.js"><link rel="prefetch" href="/assets/js/235.d5b8659d.js"><link rel="prefetch" href="/assets/js/236.9d3c0dda.js"><link rel="prefetch" href="/assets/js/237.e71354cf.js"><link rel="prefetch" href="/assets/js/238.cff44558.js"><link rel="prefetch" href="/assets/js/239.7f23329a.js"><link rel="prefetch" href="/assets/js/24.f6b3b13a.js"><link rel="prefetch" href="/assets/js/240.3e65ee32.js"><link rel="prefetch" href="/assets/js/241.22baab19.js"><link rel="prefetch" href="/assets/js/242.c322e132.js"><link rel="prefetch" href="/assets/js/243.f0e49280.js"><link rel="prefetch" href="/assets/js/244.992a4105.js"><link rel="prefetch" href="/assets/js/245.7ee2490a.js"><link rel="prefetch" href="/assets/js/246.e2d1bb5e.js"><link rel="prefetch" href="/assets/js/247.19a707d2.js"><link rel="prefetch" href="/assets/js/25.1a583097.js"><link rel="prefetch" href="/assets/js/26.3269d287.js"><link rel="prefetch" href="/assets/js/27.fe6e7564.js"><link rel="prefetch" href="/assets/js/28.8ae7f41a.js"><link rel="prefetch" href="/assets/js/29.98548c13.js"><link rel="prefetch" href="/assets/js/3.32d591e5.js"><link rel="prefetch" href="/assets/js/30.38fe89bc.js"><link rel="prefetch" href="/assets/js/31.980173ed.js"><link rel="prefetch" href="/assets/js/32.ea2ab917.js"><link rel="prefetch" href="/assets/js/33.6fbff1d2.js"><link rel="prefetch" href="/assets/js/34.80a6a622.js"><link rel="prefetch" href="/assets/js/35.798d8369.js"><link rel="prefetch" href="/assets/js/36.0d47cb5e.js"><link rel="prefetch" href="/assets/js/37.bfc24239.js"><link rel="prefetch" href="/assets/js/38.7b89037f.js"><link rel="prefetch" href="/assets/js/39.8a267784.js"><link rel="prefetch" href="/assets/js/4.f75fdd66.js"><link rel="prefetch" href="/assets/js/40.0d996214.js"><link rel="prefetch" href="/assets/js/41.6fb252a6.js"><link rel="prefetch" href="/assets/js/42.d67ea558.js"><link rel="prefetch" href="/assets/js/43.fa63a31a.js"><link rel="prefetch" href="/assets/js/44.3c10aa56.js"><link rel="prefetch" href="/assets/js/45.ab3f92fd.js"><link rel="prefetch" href="/assets/js/46.ba2c070b.js"><link rel="prefetch" href="/assets/js/47.ef5eed3f.js"><link rel="prefetch" href="/assets/js/48.15cf35c1.js"><link rel="prefetch" href="/assets/js/49.37a5bbd2.js"><link rel="prefetch" href="/assets/js/5.d68f1e4c.js"><link rel="prefetch" href="/assets/js/50.4644c443.js"><link rel="prefetch" href="/assets/js/51.58361d59.js"><link rel="prefetch" href="/assets/js/52.88c7ec45.js"><link rel="prefetch" href="/assets/js/53.8eac9b85.js"><link rel="prefetch" href="/assets/js/54.47570eee.js"><link rel="prefetch" href="/assets/js/55.51b4a703.js"><link rel="prefetch" href="/assets/js/56.6bfaf96f.js"><link rel="prefetch" href="/assets/js/57.5c6de279.js"><link rel="prefetch" href="/assets/js/58.6d223a1a.js"><link rel="prefetch" href="/assets/js/59.0bd205e8.js"><link rel="prefetch" href="/assets/js/6.ace53e17.js"><link rel="prefetch" href="/assets/js/60.dfd80f07.js"><link rel="prefetch" href="/assets/js/61.aba0065d.js"><link rel="prefetch" href="/assets/js/62.6757538e.js"><link rel="prefetch" href="/assets/js/63.c85bb5fa.js"><link rel="prefetch" href="/assets/js/64.73c48ee5.js"><link rel="prefetch" href="/assets/js/65.d4595c7e.js"><link rel="prefetch" href="/assets/js/66.f7716151.js"><link rel="prefetch" href="/assets/js/67.f78d747f.js"><link rel="prefetch" href="/assets/js/68.8153d1fb.js"><link rel="prefetch" href="/assets/js/69.02b59d04.js"><link rel="prefetch" href="/assets/js/7.2695ada1.js"><link rel="prefetch" href="/assets/js/70.618187b3.js"><link rel="prefetch" href="/assets/js/71.b40b7d38.js"><link rel="prefetch" href="/assets/js/72.ead271bd.js"><link rel="prefetch" href="/assets/js/73.d3f53f66.js"><link rel="prefetch" href="/assets/js/74.55d8e979.js"><link rel="prefetch" href="/assets/js/76.de2f904d.js"><link rel="prefetch" href="/assets/js/77.df4d6872.js"><link rel="prefetch" href="/assets/js/78.3c3fc802.js"><link rel="prefetch" href="/assets/js/79.efe4ac3e.js"><link rel="prefetch" href="/assets/js/8.54a80a1c.js"><link rel="prefetch" href="/assets/js/80.bbfb7069.js"><link rel="prefetch" href="/assets/js/81.aade11f0.js"><link rel="prefetch" href="/assets/js/82.48e590eb.js"><link rel="prefetch" href="/assets/js/83.35f84cf8.js"><link rel="prefetch" href="/assets/js/84.1b3ac405.js"><link rel="prefetch" href="/assets/js/85.ee1775e0.js"><link rel="prefetch" href="/assets/js/86.489ce6ef.js"><link rel="prefetch" href="/assets/js/87.fc179393.js"><link rel="prefetch" href="/assets/js/88.b86255a0.js"><link rel="prefetch" href="/assets/js/89.3b95d70f.js"><link rel="prefetch" href="/assets/js/9.dda7e4d1.js"><link rel="prefetch" href="/assets/js/90.b9fe18c9.js"><link rel="prefetch" href="/assets/js/91.f27a5a8c.js"><link rel="prefetch" href="/assets/js/92.64ea6110.js"><link rel="prefetch" href="/assets/js/93.2f94993b.js"><link rel="prefetch" href="/assets/js/94.11d8c6a6.js"><link rel="prefetch" href="/assets/js/95.d7cc9ce0.js"><link rel="prefetch" href="/assets/js/96.672e1061.js"><link rel="prefetch" href="/assets/js/97.48548b5a.js"><link rel="prefetch" href="/assets/js/98.92bc435b.js"><link rel="prefetch" href="/assets/js/99.713aac42.js">
    <link rel="stylesheet" href="/assets/css/0.styles.77aad89f.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.jpg" alt="Rustic blog" class="logo"> <span class="site-name can-hide">Rustic blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/server/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Java</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/java001/" class="nav-link">Jvm-指南</a></li><li class="dropdown-subitem"><a href="/pages/java002/" class="nav-link">Lambda&amp;Stream-API</a></li><li class="dropdown-subitem"><a href="/pages/java003/" class="nav-link">LocalDate大法</a></li><li class="dropdown-subitem"><a href="/pages/java004/" aria-current="page" class="nav-link router-link-exact-active router-link-active">Juc-指南</a></li><li class="dropdown-subitem"><a href="/pages/java005/" class="nav-link">Spring-指南</a></li><li class="dropdown-subitem"><a href="/pages/java006/" class="nav-link">Java类加载</a></li><li class="dropdown-subitem"><a href="/pages/java007/" class="nav-link">HashMap源码分析</a></li><li class="dropdown-subitem"><a href="/pages/java008/" class="nav-link">Mybatis 源码流程分析</a></li></ul></li><li class="dropdown-item"><h4>Linux</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/linux001/" class="nav-link">Linux-指南</a></li><li class="dropdown-subitem"><a href="/pages/linux002/" class="nav-link">Shell-指南</a></li></ul></li><li class="dropdown-item"><h4>Sql</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/sql001/" class="nav-link">Sql-指南</a></li></ul></li><li class="dropdown-item"><h4>DevOps</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/devops001/" class="nav-link">Docker-指南</a></li><li class="dropdown-subitem"><a href="/pages/devops002/" class="nav-link">K8S-指南</a></li></ul></li><li class="dropdown-item"><h4>其他</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/ohter001/" class="nav-link">ES-指南</a></li><li class="dropdown-subitem"><a href="/pages/ohter002/" class="nav-link">Git-指南</a></li><li class="dropdown-subitem"><a href="/pages/ohter003/" class="nav-link">Redis-指南</a></li><li class="dropdown-subitem"><a href="/pages/ohter004/" class="nav-link">Typora-指南</a></li><li class="dropdown-subitem"><a href="/pages/ohter005/" class="nav-link">Nginx-指南</a></li><li class="dropdown-subitem"><a href="/pages/ohter006/" class="nav-link">正则表达式-指南</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>页面</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-subitem"><a href="/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li></ul></li><li class="dropdown-item"><h4>前端文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/javascript/" class="nav-link">《JavaScript教程》</a></li><li class="dropdown-subitem"><a href="/note/js/" class="nav-link">《JavaScript高级程序设计》</a></li><li class="dropdown-subitem"><a href="/note/es6/" class="nav-link">《ES6 教程》</a></li><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">《Vue》</a></li><li class="dropdown-subitem"><a href="/note/react/" class="nav-link">《React》</a></li><li class="dropdown-subitem"><a href="/note/typescript-axios/" class="nav-link">《TypeScript 从零实现 axios》</a></li><li class="dropdown-subitem"><a href="/note/git/" class="nav-link">《Git》</a></li><li class="dropdown-subitem"><a href="/pages/51afd6/" class="nav-link">TypeScript</a></li><li class="dropdown-subitem"><a href="/pages/4643cd/" class="nav-link">JS设计模式总结</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div> <a href="https://github.com/h-qing" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/jpg.png"> <div class="blogger-info"><h3>Rustic</h3> <span>后端界的小学生</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/server/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Java</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/java001/" class="nav-link">Jvm-指南</a></li><li class="dropdown-subitem"><a href="/pages/java002/" class="nav-link">Lambda&amp;Stream-API</a></li><li class="dropdown-subitem"><a href="/pages/java003/" class="nav-link">LocalDate大法</a></li><li class="dropdown-subitem"><a href="/pages/java004/" aria-current="page" class="nav-link router-link-exact-active router-link-active">Juc-指南</a></li><li class="dropdown-subitem"><a href="/pages/java005/" class="nav-link">Spring-指南</a></li><li class="dropdown-subitem"><a href="/pages/java006/" class="nav-link">Java类加载</a></li><li class="dropdown-subitem"><a href="/pages/java007/" class="nav-link">HashMap源码分析</a></li><li class="dropdown-subitem"><a href="/pages/java008/" class="nav-link">Mybatis 源码流程分析</a></li></ul></li><li class="dropdown-item"><h4>Linux</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/linux001/" class="nav-link">Linux-指南</a></li><li class="dropdown-subitem"><a href="/pages/linux002/" class="nav-link">Shell-指南</a></li></ul></li><li class="dropdown-item"><h4>Sql</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/sql001/" class="nav-link">Sql-指南</a></li></ul></li><li class="dropdown-item"><h4>DevOps</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/devops001/" class="nav-link">Docker-指南</a></li><li class="dropdown-subitem"><a href="/pages/devops002/" class="nav-link">K8S-指南</a></li></ul></li><li class="dropdown-item"><h4>其他</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/ohter001/" class="nav-link">ES-指南</a></li><li class="dropdown-subitem"><a href="/pages/ohter002/" class="nav-link">Git-指南</a></li><li class="dropdown-subitem"><a href="/pages/ohter003/" class="nav-link">Redis-指南</a></li><li class="dropdown-subitem"><a href="/pages/ohter004/" class="nav-link">Typora-指南</a></li><li class="dropdown-subitem"><a href="/pages/ohter005/" class="nav-link">Nginx-指南</a></li><li class="dropdown-subitem"><a href="/pages/ohter006/" class="nav-link">正则表达式-指南</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>页面</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-subitem"><a href="/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li></ul></li><li class="dropdown-item"><h4>前端文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/javascript/" class="nav-link">《JavaScript教程》</a></li><li class="dropdown-subitem"><a href="/note/js/" class="nav-link">《JavaScript高级程序设计》</a></li><li class="dropdown-subitem"><a href="/note/es6/" class="nav-link">《ES6 教程》</a></li><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">《Vue》</a></li><li class="dropdown-subitem"><a href="/note/react/" class="nav-link">《React》</a></li><li class="dropdown-subitem"><a href="/note/typescript-axios/" class="nav-link">《TypeScript 从零实现 axios》</a></li><li class="dropdown-subitem"><a href="/note/git/" class="nav-link">《Git》</a></li><li class="dropdown-subitem"><a href="/pages/51afd6/" class="nav-link">TypeScript</a></li><li class="dropdown-subitem"><a href="/pages/4643cd/" class="nav-link">JS设计模式总结</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div> <a href="https://github.com/h-qing" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Java</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/java001/" class="sidebar-link">Jvm-指南</a></li><li><a href="/pages/java002/" class="sidebar-link">Lambda&amp;Stream-API</a></li><li><a href="/pages/java003/" class="sidebar-link">LocalDate大法</a></li><li><a href="/pages/java004/" aria-current="page" class="active sidebar-link">Juc-指南</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/java004/#进程与线程" class="sidebar-link">进程与线程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/java004/#进程" class="sidebar-link">进程</a></li><li class="sidebar-sub-header level3"><a href="/pages/java004/#线程" class="sidebar-link">线程</a></li><li class="sidebar-sub-header level3"><a href="/pages/java004/#二者对比" class="sidebar-link">二者对比</a></li><li class="sidebar-sub-header level3"><a href="/pages/java004/#并行与并发" class="sidebar-link">并行与并发</a></li><li class="sidebar-sub-header level3"><a href="/pages/java004/#应用" class="sidebar-link">应用</a></li><li class="sidebar-sub-header level3"><a href="/pages/java004/#应用之异步调用-案例1" class="sidebar-link">**</a></li><li class="sidebar-sub-header level4"><a href="/pages/java004/#设计" class="sidebar-link">设计</a></li><li class="sidebar-sub-header level4"><a href="/pages/java004/#结论" class="sidebar-link">结论</a></li><li class="sidebar-sub-header level3"><a href="/pages/java004/#应用之提高效率-案例1" class="sidebar-link">**</a></li><li class="sidebar-sub-header level4"><a href="/pages/java004/#设计-2" class="sidebar-link">设计</a></li><li class="sidebar-sub-header level4"><a href="/pages/java004/#结论-2" class="sidebar-link">结论</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/java004/#java-线程" class="sidebar-link">Java 线程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/java004/#本章内容" class="sidebar-link">本章内容</a></li><li class="sidebar-sub-header level3"><a href="/pages/java004/#创建和运行线程" class="sidebar-link">创建和运行线程</a></li><li class="sidebar-sub-header level4"><a href="/pages/java004/#方法一-直接使用-thread" class="sidebar-link">方法一，直接使用 Thread</a></li><li class="sidebar-sub-header level4"><a href="/pages/java004/#方法二-使用-runnable-配合-thread" class="sidebar-link">方法二，使用 Runnable 配合 Thread</a></li><li class="sidebar-sub-header level4"><a href="/pages/java004/#原理之-thread-与-runnable-的关系" class="sidebar-link">**</a></li><li class="sidebar-sub-header level4"><a href="/pages/java004/#方法三-futuretask-配合-thread" class="sidebar-link">方法三，FutureTask 配合 Thread</a></li><li class="sidebar-sub-header level3"><a href="/pages/java004/#观察多个线程同时运行" class="sidebar-link">观察多个线程同时运行</a></li><li class="sidebar-sub-header level3"><a href="/pages/java004/#查看进程线程的方法" class="sidebar-link">查看进程线程的方法</a></li><li class="sidebar-sub-header level4"><a href="/pages/java004/#windows" class="sidebar-link">windows</a></li><li class="sidebar-sub-header level4"><a href="/pages/java004/#linux" class="sidebar-link">linux</a></li><li class="sidebar-sub-header level4"><a href="/pages/java004/#java" class="sidebar-link">Java</a></li><li class="sidebar-sub-header level4"><a href="/pages/java004/#jconsole-远程监控配置" class="sidebar-link">jconsole 远程监控配置</a></li><li class="sidebar-sub-header level3"><a href="/pages/java004/#原理之线程运行" class="sidebar-link">**</a></li><li class="sidebar-sub-header level4"><a href="/pages/java004/#栈与栈帧" class="sidebar-link">栈与栈帧</a></li><li class="sidebar-sub-header level4"><a href="/pages/java004/#线程上下文切换-thread-context-switch" class="sidebar-link">线程上下文切换（Thread Context Switch）</a></li><li class="sidebar-sub-header level3"><a href="/pages/java004/#常见方法" class="sidebar-link">常见方法</a></li><li class="sidebar-sub-header level3"><a href="/pages/java004/#start-与-run" class="sidebar-link">start 与 run</a></li><li class="sidebar-sub-header level4"><a href="/pages/java004/#调用-run" class="sidebar-link">调用 run</a></li><li class="sidebar-sub-header level4"><a href="/pages/java004/#调用-start" class="sidebar-link">调用 start</a></li><li class="sidebar-sub-header level4"><a href="/pages/java004/#小结" class="sidebar-link">小结</a></li><li class="sidebar-sub-header level3"><a href="/pages/java004/#sleep-与-yield" class="sidebar-link">sleep 与 yield</a></li><li class="sidebar-sub-header level4"><a href="/pages/java004/#sleep" class="sidebar-link">sleep</a></li><li class="sidebar-sub-header level4"><a href="/pages/java004/#yield" class="sidebar-link">yield</a></li><li class="sidebar-sub-header level4"><a href="/pages/java004/#sleep-与-yield区别" class="sidebar-link">sleep 与 yield区别</a></li><li class="sidebar-sub-header level4"><a href="/pages/java004/#线程优先级" class="sidebar-link">线程优先级</a></li><li class="sidebar-sub-header level3"><a href="/pages/java004/#线程状态" class="sidebar-link">线程状态</a></li><li class="sidebar-sub-header level3"><a href="/pages/java004/#synchronized-位置" class="sidebar-link">synchronized 位置</a></li></ul></li></ul></li><li><a href="/pages/java005/" class="sidebar-link">Spring-指南</a></li><li><a href="/pages/java006/" class="sidebar-link">Java类加载</a></li><li><a href="/pages/java007/" class="sidebar-link">hashMap源码分析</a></li><li><a href="/pages/java008/" class="sidebar-link">Mybatis 源码流程分析</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Sql</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>DevOps</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Linux</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>其他</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-1baff76c><div class="articleInfo" data-v-1baff76c><ul class="breadcrumbs" data-v-1baff76c><li data-v-1baff76c><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-1baff76c></a></li> <li data-v-1baff76c><a href="/server/#后端" data-v-1baff76c>后端</a></li><li data-v-1baff76c><a href="/server/#Java" data-v-1baff76c>Java</a></li></ul> <div class="info" data-v-1baff76c><div title="作者" class="author iconfont icon-touxiang" data-v-1baff76c><a href="https://gitee.com/huang-qing" target="_blank" title="作者" class="beLink" data-v-1baff76c>hq</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-1baff76c><a href="javascript:;" data-v-1baff76c>2022-4-15</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">Juc-指南<span class="title-tag">原创</span></h1>  <div class="theme-vdoing-content content__default"><h1 id="基本概念"><a href="#基本概念" class="header-anchor">#</a> 基本概念</h1> <h2 id="进程与线程"><a href="#进程与线程" class="header-anchor">#</a> 进程与线程</h2> <h3 id="进程"><a href="#进程" class="header-anchor">#</a> 进程</h3> <ul><li>程序由指令和数据组成，但这些指令要运行，数据要读写，就必须将指令加载至 CPU，数据加载至内存。在
指令运行过程中还需要用到磁盘、网络等设备。进程就是用来加载指令、管理内存、管理 IO 的</li> <li>当一个程序被运行，从磁盘加载这个程序的代码至内存，这时就开启了一个进程。</li> <li>进程就可以视为程序的一个实例。大部分程序可以同时运行多个实例进程（例如记事本、画图、浏览器
等），也有的程序只能启动一个实例进程（例如网易云音乐、360 安全卫士等）
</li></ul> <h3 id="线程"><a href="#线程" class="header-anchor">#</a> 线程</h3> <ul><li>一个进程之内可以分为一到多个线程。</li> <li>一个线程就是一个指令流，将指令流中的一条条指令以一定的顺序交给 CPU 执行</li> <li>Java 中，线程作为最小调度单位，进程作为资源分配的最小单位。 在 windows 中进程是不活动的，只是作
为线程的容器</li></ul> <h3 id="二者对比"><a href="#二者对比" class="header-anchor">#</a> 二者对比</h3> <ul><li><p>进程基本上相互独立的，而线程存在于进程内，是进程的一个子集</p></li> <li><p>进程拥有共享的资源，如内存空间等，供其内部的线程共享</p></li> <li><p>进程间通信较为复杂</p> <ul><li>同一台计算机的进程通信称为 IPC（Inter-process communication）</li> <li>不同计算机之间的进程通信，需要通过网络，并遵守共同的协议，例如 HTTP</li></ul></li> <li><p>线程通信相对简单，因为它们共享进程内的内存，一个例子是多个线程可以访问同一个共享变量</p></li> <li><p>线程更轻量，线程上下文切换成本一般上要比进程上下文切换低</p></li></ul> <h3 id="并行与并发"><a href="#并行与并发" class="header-anchor">#</a> 并行与并发</h3> <p>单核 cpu 下，线程实际还是 <font color="red"><strong>串行执行</strong></font> 的。操作系统中有一个组件叫做任务调度器，将 cpu 的时间片（windows
下时间片最小约为 15 毫秒）分给不同的程序使用，只是由于 cpu 在线程间（时间片很短）的切换非常快，人类感
觉是 <strong><font color="red">同时运行的</font></strong> 。总结为一句话就是： <strong><font color="red">微观串行，宏观并行</font></strong>，</p> <p>一般会将这种 线程轮流使用 CPU 的做法称为并发， concurrent</p> <p><img src="https://s2.loli.net/2022/01/11/GkFXg4ECHiedSnB.png" alt="image-20220111140258851"></p> <p><img src="https://s2.loli.net/2022/01/11/7WExHYdZt2v9aOV.png" alt="image-20220111140323919"></p> <p>多核 cpu下，每个 <strong><font color="red">核（core）</font></strong> 都可以调度运行线程，这时候线程可以是并行的。</p> <p><img src="https://s2.loli.net/2022/01/11/V2JXjKQTxY3mPEB.png" alt="image-20220111140406370"></p> <p><img src="https://s2.loli.net/2022/01/11/vjbQqyUFtkVPlCn.png" alt="image-20220111140414819"></p> <p>引用 Rob Pike 的一段描述：</p> <ul><li><p>并发（concurrent）是同一时间应对（dealing with）多件事情的能力</p></li> <li><p>并行（parallel）是同一时间动手做（doing）多件事情的能力</p></li></ul> <p>例子</p> <ul><li><p>家庭主妇做饭、打扫卫生、给孩子喂奶，她一个人轮流交替做这多件事，这时就是并发</p></li> <li><p>家庭主妇雇了个保姆，她们一起这些事，这时既有并发，也有并行（这时会产生竞争，例如锅只有一口，一
个人用锅时，另一个人就得等待）</p></li> <li><p>雇了3个保姆，一个专做饭、一个专打扫卫生、一个专喂奶，互不干扰，这时是并行</p></li></ul> <blockquote><p>Rob Pike 资料</p> <ul><li>golang 语言的创造者</li> <li>Rob Pike - 百度百科</li></ul></blockquote> <h3 id="应用"><a href="#应用" class="header-anchor">#</a> 应用</h3> <h3 id="应用之异步调用-案例1"><a href="#应用之异步调用-案例1" class="header-anchor">#</a> <strong><font color="red">应用之异步调用（案例1)</font></strong></h3> <p>以调用方角度来讲，如果</p> <ul><li>需要等待结果返回，才能继续运行就是同步</li> <li>不需要等待结果返回，就能继续运行就是异步</li></ul> <h4 id="设计"><a href="#设计" class="header-anchor">#</a> 设计</h4> <p>多线程可以让方法执行变为异步的（即不要巴巴干等着）比如说读取磁盘文件时，假设读取操作花费了 5 秒钟，如
果没有线程调度机制，这 5 秒 cpu 什么都做不了，其它代码都得暂停...</p> <h4 id="结论"><a href="#结论" class="header-anchor">#</a> 结论</h4> <ul><li>比如在项目中，视频文件需要转换格式等操作比较费时，这时开一个新线程处理视频转换，避免阻塞主线程</li> <li>tomcat 的异步 servlet 也是类似的目的，让用户线程处理耗时较长的操作，避免阻塞 tomcat 的工作线程</li> <li>ui 程序中，开线程进行其他操作，避免阻塞 ui 线程</li></ul> <h3 id="应用之提高效率-案例1"><a href="#应用之提高效率-案例1" class="header-anchor">#</a> <strong><font color="red">应用之提高效率（案例1）</font></strong></h3> <p>充分利用多核 cpu 的优势，提高运行效率。想象下面的场景，执行 3 个计算，最后将计算结果汇总。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>计算 <span class="token number">1</span> 花费 <span class="token number">10</span> ms
    
计算 <span class="token number">2</span> 花费 <span class="token number">11</span> ms
    
计算 <span class="token number">3</span> 花费 <span class="token number">9</span> ms
    
汇总需要 <span class="token number">1</span> ms
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>如果是串行执行，那么总共花费的时间是 10 + 11 + 9 + 1 = <strong><font color="red">31ms</font></strong></li> <li>但如果是四核 cpu，各个核心分别使用线程 1 执行计算 1，线程 2 执行计算 2，线程 3 执行计算 3，那么 3 个线程是并行的，花费时间只取决于最长的那个线程运行的时间，即 <strong><font color="red">11ms</font></strong> 最后加上汇总时间只会花费 <strong><font color="red">12ms</font></strong></li></ul> <blockquote><p>注意</p> <p>需要在多核 cpu 才能提高效率，单核仍然时是轮流执行</p></blockquote> <h4 id="设计-2"><a href="#设计-2" class="header-anchor">#</a> 设计</h4> <blockquote><p><strong><font color="red">&gt;&gt;&gt;&gt;&gt;代码见【应用之效率-案例1】&lt;&lt;&lt;&lt;&lt;</font></strong></p></blockquote> <h4 id="结论-2"><a href="#结论-2" class="header-anchor">#</a> 结论</h4> <ol><li>单核 cpu 下，多线程不能实际提高程序运行效率，只是为了能够在不同的任务之间切换，不同线程轮流使用
cpu ，不至于一个线程总占用 cpu，别的线程没法干活</li> <li>多核 cpu 可以并行跑多个线程，但能否提高程序运行效率还是要分情况的</li></ol> <ul><li>有些任务，经过精心设计，将任务拆分，并行执行，当然可以提高程序的运行效率。但不是所有计算任
务都能拆分（参考后文的【阿姆达尔定律】）</li> <li>也不是所有任务都需要拆分，任务的目的如果不同，谈拆分和效率没啥意义</li></ul> <ol start="3"><li>IO 操作不占用 cpu，只是我们一般拷贝文件使用的是【阻塞 IO】，这时相当于线程虽然不用 cpu，但需要一
直等待 IO 结束，没能充分利用线程。所以才有后面的【非阻塞 IO】和【异步 IO】优化</li></ol> <h2 id="java-线程"><a href="#java-线程" class="header-anchor">#</a> Java 线程</h2> <h3 id="本章内容"><a href="#本章内容" class="header-anchor">#</a> 本章内容</h3> <ul><li>创建和运行线程</li> <li>查看线程</li> <li>线程 API</li> <li>线程状态</li></ul> <h3 id="创建和运行线程"><a href="#创建和运行线程" class="header-anchor">#</a> 创建和运行线程</h3> <h4 id="方法一-直接使用-thread"><a href="#方法一-直接使用-thread" class="header-anchor">#</a> 方法一，直接使用 Thread</h4> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 创建线程对象</span>
<span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 要执行的任务</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 启动线程</span>
t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>例如：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 构造方法的参数是给线程指定名字，推荐</span>
<span class="token class-name">Thread</span> t1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token string">&quot;t1&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token comment">// run 方法内实现了要执行的任务</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
t1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>输出:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token number">19</span><span class="token operator">:</span><span class="token number">19</span><span class="token operator">:</span><span class="token number">00</span> <span class="token punctuation">[</span>t1<span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">c<span class="token punctuation">.</span></span>ThreadStarter</span> <span class="token operator">-</span> hello
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="方法二-使用-runnable-配合-thread"><a href="#方法二-使用-runnable-配合-thread" class="header-anchor">#</a> 方法二，使用 Runnable 配合 Thread</h4> <p>把【线程】和【任务】（要执行的代码）分开</p> <ul><li>Thread 代表线程</li> <li>Runnable 可运行的任务（线程要执行的代码）</li></ul> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Runnable</span> runnable <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 要执行的任务</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 创建线程对象</span>
<span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span> runnable <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 启动线程</span>
t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>例如：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 创建任务对象</span>
<span class="token class-name">Runnable</span> task2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    	log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 参数1 是任务对象; 参数2 是线程名字，推荐</span>
<span class="token class-name">Thread</span> t2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>task2<span class="token punctuation">,</span> <span class="token string">&quot;t2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
t2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>输出:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token number">19</span><span class="token operator">:</span><span class="token number">19</span><span class="token operator">:</span><span class="token number">00</span> <span class="token punctuation">[</span>t2<span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">c<span class="token punctuation">.</span></span>ThreadStarter</span> <span class="token operator">-</span> hello
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Java 8 以后可以使用 lambda 精简代码</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 创建任务对象</span>
<span class="token class-name">Runnable</span> task2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 参数1 是任务对象; 参数2 是线程名字，推荐</span>
<span class="token class-name">Thread</span> t2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>task2<span class="token punctuation">,</span> <span class="token string">&quot;t2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
t2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="原理之-thread-与-runnable-的关系"><a href="#原理之-thread-与-runnable-的关系" class="header-anchor">#</a> <strong><font color="red">原理之 Thread 与 Runnable 的关系</font></strong></h4> <p>分析 Thread 的源码，理清它与 Runnable 的关系</p> <p><strong>小结</strong></p> <ul><li>方法1 是把线程和任务合并在了一起，方法2 是把线程和任务分开了</li> <li>用 Runnable 更容易与线程池等高级 API 配合</li> <li>用 Runnable 让任务类脱离了 Thread 继承体系，更灵活</li></ul> <h4 id="方法三-futuretask-配合-thread"><a href="#方法三-futuretask-配合-thread" class="header-anchor">#</a> 方法三，FutureTask 配合 Thread</h4> <p>FutureTask 能够接收 Callable 类型的参数，用来处理有返回结果的情况</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 创建任务对象</span>
<span class="token class-name">FutureTask</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> task3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FutureTask</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 参数1 是任务对象; 参数2 是线程名字，推荐</span>
<span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>task3<span class="token punctuation">,</span> <span class="token string">&quot;t3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 主线程阻塞，同步等待 task 执行完毕的结果</span>
<span class="token class-name">Integer</span> result <span class="token operator">=</span> task3<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;结果是:{}&quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>输出:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token number">19</span><span class="token operator">:</span><span class="token number">22</span><span class="token operator">:</span><span class="token number">27</span> <span class="token punctuation">[</span>t3<span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">c<span class="token punctuation">.</span></span>ThreadStarter</span> <span class="token operator">-</span> hello
<span class="token number">19</span><span class="token operator">:</span><span class="token number">22</span><span class="token operator">:</span><span class="token number">27</span> <span class="token punctuation">[</span>main<span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">c<span class="token punctuation">.</span></span>ThreadStarter</span> <span class="token operator">-</span> 结果是<span class="token operator">:</span><span class="token number">100</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="观察多个线程同时运行"><a href="#观察多个线程同时运行" class="header-anchor">#</a> 观察多个线程同时运行</h3> <p><strong>主要是理解</strong></p> <ul><li>交替执行</li> <li>谁先谁后，不由我们控制</li></ul> <h3 id="查看进程线程的方法"><a href="#查看进程线程的方法" class="header-anchor">#</a> 查看进程线程的方法</h3> <h4 id="windows"><a href="#windows" class="header-anchor">#</a> windows</h4> <ul><li>任务管理器可以查看进程和线程数，也可以用来杀死进程</li> <li><code>tasklist</code> 查看进程</li> <li><code>taskkill</code> 杀死进程</li></ul> <h4 id="linux"><a href="#linux" class="header-anchor">#</a> linux</h4> <ul><li><code>ps -fe</code> 查看所有进程</li> <li><code>ps -fT -p &lt;PID&gt;</code> 查看某个进程（PID）的所有线程</li> <li><code>kill</code> 杀死进程</li> <li><code>top 按大写 H</code> 切换是否显示线程</li> <li><code>top -H -p &lt;PID&gt;</code> 查看某个进程（PID）的所有线程</li></ul> <h4 id="java"><a href="#java" class="header-anchor">#</a> Java</h4> <ul><li><code>jps</code> 命令查看所有 Java 进程</li> <li><code>jstack &lt;PID&gt;</code> 查看某个 Java 进程（PID）的所有线程状态</li> <li><code>jconsole</code> 来查看某个 Java 进程中线程的运行情况（图形界面）</li></ul> <h4 id="jconsole-远程监控配置"><a href="#jconsole-远程监控配置" class="header-anchor">#</a> jconsole 远程监控配置</h4> <ul><li>需要以如下方式运行你的 java 类</li></ul> <div class="language-java line-numbers-mode"><pre class="language-java"><code>java <span class="token operator">-</span><span class="token class-name">Djava</span><span class="token punctuation">.</span>rmi<span class="token punctuation">.</span>server<span class="token punctuation">.</span>hostname<span class="token operator">=</span>`ip地址` <span class="token operator">-</span><span class="token class-name">Dcom</span><span class="token punctuation">.</span>sun<span class="token punctuation">.</span>management<span class="token punctuation">.</span>jmxremote <span class="token operator">-</span>
<span class="token class-name">Dcom</span><span class="token punctuation">.</span>sun<span class="token punctuation">.</span>management<span class="token punctuation">.</span>jmxremote<span class="token punctuation">.</span>port<span class="token operator">=</span>`连接端口` <span class="token operator">-</span><span class="token class-name">Dcom</span><span class="token punctuation">.</span>sun<span class="token punctuation">.</span>management<span class="token punctuation">.</span>jmxremote<span class="token punctuation">.</span>ssl<span class="token operator">=</span>是否安全连接 <span class="token operator">-</span>
<span class="token class-name">Dcom</span><span class="token punctuation">.</span>sun<span class="token punctuation">.</span>management<span class="token punctuation">.</span>jmxremote<span class="token punctuation">.</span>authenticate<span class="token operator">=</span>是否认证 java类
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>修改 /etc/hosts 文件将 127.0.0.1 映射至主机名</li></ul> <p><strong>如果要认证访问，还需要做如下步骤</strong></p> <ul><li>复制 jmxremote.password 文件</li> <li>修改 jmxremote.password 和 jmxremote.access 文件的权限为 600 即文件所有者可读写</li> <li>连接时填入 controlRole（用户名），R&amp;D（密码）</li></ul> <h3 id="原理之线程运行"><a href="#原理之线程运行" class="header-anchor">#</a> <strong><font color="red">原理之线程运行</font></strong></h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">cn<span class="token punctuation">.</span>itcast<span class="token punctuation">.</span>n3</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestFrames</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread</span> t1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">method1</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        t1<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;t1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">method1</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">method1</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> y <span class="token operator">=</span> x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token class-name">Object</span> m <span class="token operator">=</span> <span class="token function">method2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Object</span> <span class="token function">method2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Object</span> n <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> n<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p><img src="https://s2.loli.net/2022/01/13/Ye6QgbiGA5UEHdr.png" alt="image-20220113134616321"></p> <h4 id="栈与栈帧"><a href="#栈与栈帧" class="header-anchor">#</a> 栈与栈帧</h4> <p>Java Virtual Machine Stacks （Java 虚拟机栈）</p> <p>我们都知道 JVM 中由堆、栈、方法区所组成，其中栈内存是给谁用的呢？其实就是线程，每个线程启动后，虚拟
机就会为其分配一块栈内存。</p> <ul><li>每个栈由多个栈帧（Frame）组成，对应着每次方法调用时所占用的内存</li> <li>每个线程只能有一个活动栈帧，对应着当前正在执行的那个方法</li></ul> <h4 id="线程上下文切换-thread-context-switch"><a href="#线程上下文切换-thread-context-switch" class="header-anchor">#</a> 线程上下文切换（Thread Context Switch）</h4> <p>因为以下一些原因导致 cpu 不再执行当前的线程，转而执行另一个线程的代码</p> <ul><li>线程的 cpu 时间片用完</li> <li>垃圾回收</li> <li>有更高优先级的线程需要运行</li> <li>线程自己调用了 sleep、yield、wait、join、park、synchronized、lock 等方法</li></ul> <p>当 Context Switch 发生时，需要由操作系统保存当前线程的状态，并恢复另一个线程的状态，Java 中对应的概念
就是程序计数器（Program Counter Register），它的作用是记住下一条 jvm 指令的执行地址，是线程私有的</p> <ul><li>状态包括程序计数器、虚拟机栈中每个栈帧的信息，如局部变量、操作数栈、返回地址等</li> <li>Context Switch 频繁发生会影响性能</li></ul> <p>示例：</p> <p><video src="C:/Users/Administrator/Videos/Captures/juc-%E7%BA%BF%E7%A8%8B%E4%B8%8A%E4%B8%8B%E6%96%87%E5%88%87%E6%8D%A2.mp4"></video></p> <h3 id="常见方法"><a href="#常见方法" class="header-anchor">#</a> 常见方法</h3> <p><img src="https://s2.loli.net/2022/01/13/oKpsYDeU7T5kBvC.png" alt="image-20220113144154670"></p> <p><img src="https://s2.loli.net/2022/01/13/prFUNYLMIndtcAZ.png" alt="image-20220113144215674"></p> <h3 id="start-与-run"><a href="#start-与-run" class="header-anchor">#</a> start 与 run</h3> <h4 id="调用-run"><a href="#调用-run" class="header-anchor">#</a> 调用 run</h4> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Thread</span> t1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token string">&quot;t1&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">FileReader</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token class-name">Constants</span><span class="token punctuation">.</span>MP4_FULL_PATH<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    t1<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;do other things ...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>输出</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>19:39:14 [main] c.TestStart - main
19:39:14 [main] c.FileReader - read [1.mp4] start ...
19:39:18 [main] c.FileReader - read [1.mp4] end ... cost: 4227 ms
19:39:18 [main] c.TestStart - do other things ...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>程序仍在 main 线程运行， <strong><font color="red">FileReader.read()</font></strong> 方法调用还是同步的</p> <h4 id="调用-start"><a href="#调用-start" class="header-anchor">#</a> 调用 start</h4> <p>将上述代码的 <strong><font color="red">t1.run()</font></strong> 改为</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>t1.start();
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>输出</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>19:41:30 [main] c.TestStart - do other things ...
19:41:30 [t1] c.TestStart - t1
19:41:30 [t1] c.FileReader - read [1.mp4] start ...
19:41:35 [t1] c.FileReader - read [1.mp4] end ... cost: 4542 ms
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>程序在 t1 线程运行， <strong><font color="red">FileReader.read()</font></strong> 方法调用是异步的</p> <h4 id="小结"><a href="#小结" class="header-anchor">#</a> 小结</h4> <ul><li>直接调用 run 是在主线程中执行了 run，没有启动新的线程</li> <li>使用 start 是启动新的线程，通过新的线程间接执行 run 中的代码</li></ul> <h3 id="sleep-与-yield"><a href="#sleep-与-yield" class="header-anchor">#</a> sleep 与 yield</h3> <h4 id="sleep"><a href="#sleep" class="header-anchor">#</a> sleep</h4> <ol><li>调用 sleep 会让当前线程从 Running 进入 Timed Waiting 状态（阻塞）</li> <li>其它线程可以使用 interrupt 方法打断正在睡眠的线程，这时 sleep 方法会抛出 InterruptedException</li> <li>睡眠结束后的线程未必会立刻得到执行</li> <li>建议用 TimeUnit 的 sleep 代替 Thread 的 sleep 来获得更好的可读性</li></ol> <h4 id="yield"><a href="#yield" class="header-anchor">#</a> yield</h4> <ol><li>调用 yield 会让当前线程从 Running 进入 Runnable 就绪状态，然后调度执行其它线程</li> <li>具体的实现依赖于操作系统的任务调度器（并不一定让的出去 要看当前是否有别的线程要运行）</li></ol> <h4 id="sleep-与-yield区别"><a href="#sleep-与-yield区别" class="header-anchor">#</a> sleep 与 yield区别</h4> <ol><li>sleep 从 Running 进入 Timed Waiting 状态（阻塞）不能被重新安排调度</li> <li>yield 会让当前线程从 Running 进入 Runnable 就绪状态 可以重新被安排调度</li></ol> <h4 id="线程优先级"><a href="#线程优先级" class="header-anchor">#</a> 线程优先级</h4> <ul><li>线程优先级会提示（hint）调度器优先调度该线程，但它仅仅是一个提示，调度器可以忽略它</li> <li>如果 cpu 比较忙，那么优先级高的线程会获得更多的时间片，但 cpu 闲时，优先级几乎没作用</li></ul> <div class="language-- java line-numbers-mode"><pre class="language-text"><code>package cn.itcast.n3;

import lombok.extern.slf4j.Slf4j;

@Slf4j(topic = &quot;c.TestYield&quot;)
public class TestYield {
    public static void main(String[] args) {
        Runnable task1 = () -&gt; {
            int count = 0;
            for (;;) {
                System.out.println(&quot;----&gt;1 &quot; + count++);
            }
        };
        Runnable task2 = () -&gt; {
            int count = 0;
            for (;;) {
//                Thread.yield();
                System.out.println(&quot;              ----&gt;2 &quot; + count++);
            }
        };
        Thread t1 = new Thread(task1, &quot;t1&quot;);
        Thread t2 = new Thread(task2, &quot;t2&quot;);
        t1.setPriority(Thread.MIN_PRIORITY);
        t2.setPriority(Thread.MAX_PRIORITY);
        t1.start();
        t2.start();
    }

}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h3 id="线程状态"><a href="#线程状态" class="header-anchor">#</a> 线程状态</h3> <ol><li>初始(NEW)：新创建了一个线程对象，但还没有调用start()方法。</li> <li>运行(RUNNABLE)：Java线程中将就绪（ready）和运行中（running）两种状态笼统的称为“运行”。
线程对象创建后，其他线程(比如main线程）调用了该对象的start()方法。该状态的线程位于可运行线程池中，等待被线程调度选中，获取CPU的使用权，此时处于就绪状态（ready）。就绪状态的线程在获得CPU时间片后变为运行中状态（running）。</li> <li>阻塞(BLOCKED)：表示线程阻塞于锁。</li> <li>等待(WAITING)：进入该状态的线程需要等待其他线程做出一些特定动作（通知或中断）。</li> <li>超时等待(TIMED_WAITING)：该状态不同于WAITING，它可以在指定的时间后自行返回。</li> <li>终止(TERMINATED)：表示该线程已经执行完毕。</li></ol> <p><img src="https://s2.loli.net/2022/02/08/XqtPcFYjzVaQyvs.jpg" alt="线程状态图"></p> <h3 id="synchronized-位置"><a href="#synchronized-位置" class="header-anchor">#</a> synchronized 位置</h3> <p><strong>1、对于静态方法，由于此时对象还未生成，所以只能采用类锁；</strong></p> <p><strong>2、只要采用类锁，就会拦截所有线程，只能让一个线程访问。</strong></p> <p><strong>3、对于对象锁（this），如果是同一个实例，就会按顺序访问，但是如果是不同实例，就可以同时访问</strong></p> <p><strong>4、如果对象锁跟访问的对象没有关系，那么就会都同时访问。</strong></p></div></div>  <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=Java" title="标签">#Java</a><a href="/tags/?tag=%E5%A4%9A%E7%BA%BF%E7%A8%8B" title="标签">#多线程</a><a href="/tags/?tag=JUC" title="标签">#JUC</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/04/16, 12:31:20</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/java003/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">LocalDate大法</div></a> <a href="/pages/java005/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">Spring-指南</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/java003/" class="prev">LocalDate大法</a></span> <span class="next"><a href="/pages/java005/">Spring-指南</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/ace3d3/"><div>
            常用的后端轮子
            <!----></div></a> <span class="date">04-16</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/mark001/"><div>
            Markdown画图
            <span class="title-tag">
              原创
            </span></div></a> <span class="date">4-15</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/java002/"><div>
            Lambda&amp;Stream-API
            <span class="title-tag">
              原创
            </span></div></a> <span class="date">4-15</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:hq.email@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/h-qing" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://gitee.com/huang-qing" title="Gitee" target="_blank" class="iconfont icon-gitee"></a><a href="https://music.163.com/" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2022
    <span>Rustic <!--| <a href="https://github.com/xugaoyi/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License--></a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div class="Sakura" data-v-248d85d6><canvas id="canvas_sakura" style="z-index:-1;" data-v-248d85d6></canvas></div><div class="kanbanniang" data-v-5775ee02><div class="banniang-container" style="display:;" data-v-5775ee02><div class="messageBox" style="right:68px;bottom:190px;display:none;" data-v-5775ee02>
      hello!
    </div> <div class="operation" style="right:90px;bottom:40px;display:;" data-v-5775ee02><i class="kbnfont kbn-ban-home ban-home" data-v-5775ee02></i> <i class="kbnfont kbn-ban-message message" data-v-5775ee02></i> <i class="kbnfont kbn-ban-close close" data-v-5775ee02></i> <a target="_blank" href="https://vuepress-theme-reco.recoluan.com/views/plugins/kanbanniang.html" data-v-5775ee02><i class="kbnfont kbn-ban-info info" data-v-5775ee02></i></a> <i class="kbnfont kbn-ban-theme skin" style="display:none;" data-v-5775ee02></i></div> <canvas id="banniang" width="150" height="220" class="live2d" style="right:90px;bottom:-20px;opacity:0.9;" data-v-5775ee02></canvas></div> <div class="showBanNiang" style="display:none;" data-v-5775ee02>
    看板娘
  </div></div><div></div><canvas id="vuepress-canvas-cursor"></canvas><APlayer audio="" fixed="true" mini="true" autoplay="autoplay" theme="#b7daff" loop="loop" order="random" preload="auto" volume="0.3" mutex="true" lrc-type="3" list-max-height="250" storage-name="vuepress-plugin-meting" id="aplayer-fixed"></APlayer><div></div></div></div>
    <script src="/assets/js/app.70f22179.js" defer></script><script src="/assets/js/2.c58500da.js" defer></script><script src="/assets/js/75.51a2bc6f.js" defer></script>
  </body>
</html>
